[tox]
envlist = py{36,37,38,39}-sphinx{2,3,4},py{36}-flake8,docs

[testenv]
extras = testing
setenv =
    PYTHONPATH = {toxinidir}:{toxinidir}/sphinx_charts
commands =
    coverage run --source sphinx_charts -m unittest discover
    coverage report --show-missing
deps =
    coverage==5.2.1
    sphinx2: sphinx>=2,<3
    sphinx3: sphinx>=3,<4
    sphinx4: sphinx>=4,<5

[testenv:py36-flake8]
commands = flake8 .
deps =
    flake8
    flake8-print

[testenv:docs]
whitelist_externals = rm
deps =
    sphinx>=4,<5
    sphinx-rtd-theme==1.0.0
    sphinx-tabs>=1.2
    docutils>=0.16
    sphinx_math_dollar==1.1.1
commands =
    rm -rf docs/doctrees
    rm -rf docs/html
    sphinx-build -b html -d docs/doctrees docs/source docs/html
